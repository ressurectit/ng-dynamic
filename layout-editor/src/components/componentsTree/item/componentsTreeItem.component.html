<div class="flex align-items-center" [ngClass]="hasChildren ? 'nested-node-tree' : 'node-tree'">
    <button type="button" mat-icon-button [disabled]="!hasChildren" (click)="toggle()"
        [attr.aria-label]="'Toggle'">
        <span class="fa" *ngIf="hasChildren" [ngClass]="open ? 'fa-chevron-down' : 'fa-chevron-right'"></span>
    </button>
    <div 
        [class.selected]="data?.id === _manager.selectedComponent"
        [class.highlighted]="data?.id === _manager.highlightedComponent"
        (mouseover)="highlight($event, data?.id)"
        (click)="_manager.selectComponent(data?.id)">{{data?.displayName || data?.id}}</div>
</div>

<div class="node-children" 
        cdkDropList
        
        [cdkDropListEnterPredicate]="_canDrop"
        [id]="'component-tree-' + data?.id"
        *ngIf="hasChildren || _canDrop()"
        [class.hidden]="!open"
        connectDropLists
        connectDropListsPrefix="component-tree-">
        <!-- (cdkDropListDropped)="data?.component?.addDescendant($event)" -->
    <div 
        *ngFor="let child of children"
        cdkDrag 
        [cdkDragData]="{metadata: child, parentId: data?.id}"
        [cdkDragDisabled]="false"
        class="node-child">
        <components-tree-item [data]="child"></components-tree-item>
    </div>
</div>